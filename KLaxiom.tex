\chapter{The general KL axiom} \label{sec:genkl}

\section{A closer look at the first axiom} \label{ax1re}

Let \( (a,b)\in R\times R \). To this pair we can associate the function
\begin{equation*}
  f:D\to R
  \atop
  d\mapsto a + bd
\end{equation*}

In this manner we obtain a map
\begin{equation*}
  \alpha : R\times R\to R^D
\end{equation*}

Axiom \ref{KL1} can then be succinctly stated by demanding that \( \alpha \) be bijective. Note that the \( R \)-module structure is also preserved, so that \( \alpha \) is an \( R \)-module isomorphism. Furthermore, \( R^D \) has a natural \( R \)-algebra structure given by the pointwise product of maps:

\begin{align}
  (a_1 + b_1d)(a_2 + b_2d) & = a_1a_2 + (a_1b_2 + b_1a_2)d + b_1b_2d^2 \\
                           & = a_1a_2 + (a_1b_2 + b_1a_2)d
  \label{R-alg}
\end{align}

As such, \( R\times R \) does not possess an \( R \)-algebra structure, but if we define a product by the above formula, that is
\begin{equation*}
  (a_1,b_1)\cdot(a_2,b_2) = (a_1a_2,a_1b_2 + b_1a_2)
\end{equation*}
then \( \alpha  \) is an \( R \)-algebra isomorphism.

It will be helpful for motivating the forthcoming definitions to state this in yet another way. The previous structure on \( R\times R \) is nothing more than the natural \( R \)-algebra on
\begin{equation*}
  W = \quot{R[X]}{(X^2)}
\end{equation*}
thus there is an isomorphism of \( R \)-algebras
\begin{equation*}
  W \stackrel{\alpha}{\cong} R^D
\end{equation*}

In the following section we will generalize this idea.

\section{Weil Algebras}

The infinitesimals \( D \) are one among many other ``small objects'' in SDG, called \emph{Weil algebras}, due to Andr√© Weil. We will use the general definition as per \cite{bun17}.

\begin{defn}
  A \emph{Weil algebra} \( W \) is a \( \Q \)-algebra together with a morphism
  \begin{equation*}
    \pi: W\to\Q
  \end{equation*}
  such that \( W \) is a local ring with maximal ideal \( I=\pi^{-1}(0) \) with \( I \) nilpotent and such that \( W \) is finite dimensional as a \( \Q \) vector space. A homomorphism of Weil algebras \( f:W_1\to W_2 \) is thus an algebra homomorphism sending the maximal ideal of \( W_1 \) to that of \( W_2 \).
\end{defn}



It will do to explore some simple consequences of this definition.

\begin{lemma}
  Any Weil algebra \( W \) may be finitely presented, that is, \( W \) is isomorphic to
  \begin{equation*}
    \Q[X_1,\dots,X_n]/(P_1,\dots,P_s)
  \end{equation*}
  where \( P_1,\dots P_s \) are polynomials of \( \Q[X_1,\dots,X_n] \).
  \label{lm:finpr}
\end{lemma}

\begin{proof}
  Let \( e_1,\dots,e_n \) be a \( \Q \)-basis of \( W \). The algebra structure is then determined by the constants \( \gamma_{ij}^k \) given by
  \begin{equation*}
    e_i\cdot e_j = \sum_{k=1}^n \gamma_{ij}^ke_k
  \end{equation*}
  in other words, the kernel of the surjection
  \begin{equation*}
    E: \Q[X_1,\dots,X_n]\to W
  \end{equation*}
  given by \( X_k\mapsto e_k \) is the ideal generated by the polynomials
  \begin{equation*}
    X_iX_j - \sum_{k=1}^n\gamma_{ij}^kX_k
  \end{equation*}
  With \( 1\leq i,j\leq n \). Thus \( W \) is isomorphic to \( \Q[X_1,\dots,X_n]/\ker E \) with \( \ker E \) finitely generated.
\end{proof}

Naturally, there is no reason for \( X_1,\dots,X_n \) to be a minimal set of generators. In \cite{lav96}, this minimal number of generators is referred to as the \emph{breadth} of a Weil algebra, and the smallest power that annihilates the maximal ideal as the \emph{height}.

%TODO:prove this
That a Weil algebra \( W \) is finite dimensional over \( \Q \) means that it is isomorphic to \( \Q^n \) with a certain product given by \( \gamma_{ij}^k \), for some \( n \). If \( A \) is any other \( \Q \)-algebra, then so can \( A^n \) be endowed with a product by letting \( e_ie_j = \gamma_{ij}^ke_k \) where \( e_l = (0,\stackrel{(l)}{\dots},1,\dots,0) \), making \( A^n \) an \( A \)-algebra. This structure is manifestly dependent on the \( e_l \). However, it does not depend on the presentation of \( W \). This algebra structure on \( A^n \) is denoted \( A[W] \). For instance, the \( R \)-algebra on \( R\times R \) from (\ref{R-alg}) arises in this way as \( R[W] \), where
\begin{equation*}
  W = \Q[X]/(X^2)
\end{equation*}
If we repeat the steps that we took to obtain a presentation of a Weil algebra \( W \cong \mathbb{Q}[X_1,\dots,X_n]/(P_1,\dots,P_s) \) then it's clear that for any other \( \mathbb{Q} \)-algebra \( A \), the algebra \( A[W] \) is also presented as \( A[X_1,\dots,X_n](P_1,\dots,P_s) \).

It's worth mentioning that in \cite{lav96}, the author defines Weil algebras directly as objects which according to our definition arise as \( R[W] \) with \( W \) a Weil algebra as defined above. The distinction is that \( R[W] \) need not be a local ring (for instance, (\ref{R-alg}) has the ideal \( ((0,a)) \) with \( a\in R \) which is not maximal since any element \( (d,0) \) with \( d\in D \) is in its complement, but it is not a unit. However this only changes the phrasing involved for the general KL axiom (the goal of this section), and not the content.

\section{Spectra of Weil Algebras}

The final piece involved in the statement of the general KL axiom is that of the \emph{spectrum} of a Weil algebra.
\begin{defn}
  Let \( W \) be a Weil algebra, and \( C \) be an \( R \)-algebra. If \( W \) is presented as 
  \begin{equation*}
    \Q[X_1,\dots,X_n]/(P_1\dots,P_s)
  \end{equation*}
  the \emph{spectrum} of \( W \) in \( C \) is
  \begin{equation*}
    \spec_C{W} = \{(a_1,\dots,a_n)\in C^n \mid P_j(a_1,\dots,a_n) = 0, j=1,\dots,s\} 
    \label{def:spec}
  \end{equation*}
\end{defn}
It is not difficult but it is prudent to check that this is well defined. In fact we shall prove that \( \spec_C(\farg) \) is functorial. Note that elements of \( \spec_C(W) \) can be ``evaluated'' at by classes in \( W \), since two representatives differ by an element of \( I=(P_1,\dots,P_j) \), but every polynomial in \( I \) is zero on \( \spec_C(W) \) by definition. We shorten such an evaluation, \( (P+I)(a) \), simply to \( P(a) \). 

Let \( W_1, W_2 \) be Weil algebras, with
\begin{align*}
  W_1 &\cong \Q[X_1,\dots,X_n]/I \\
  W_2 &\cong \Q[Y_1,\dots,Y_n]/J
\end{align*}
Now let \( f:W_1\to W_2 \) be a homomorphism of Weil algebras. Define
\begin{equation*}
  \spec_C(f):\spec_C(W_2)\to \spec_C(W_1)
\end{equation*}
by
\begin{equation*}
  \spec_C(f)(b_1,\dots,b_m) = (a_1,\dots,a_n)
\end{equation*}
where
\begin{equation*}
  a_i = f(X_i)(b_1,\dots,b_m)
\end{equation*}

We have
\begin{enumerate}
  \item \(\spec_C(\farg)\) preserves identities.
    In effect, the identity on a Weil algebra \( \id_W \) sends \( X_i \) to \( X_i \), and since \( X_i(b_1,\dots,b_m) = b_i \) so is \( \spec_C(\id_W) \) the identity on \( \spec_C(W) \).
  \item \(\spec_C(g\circ f) = \spec_C(f)\circ \spec_C(g)\), where defined. The proof is a simple verification.
\end{enumerate}

By virtue of the (contravariant) functoriality we get as a corollary that isomorphic Weil algebras induce a bijection on their spectra. With these definitions in place we may state the complete version of the KL axiom.

\section{The KL Axiom}

Let \( W\cong \mathbb{Q}[X_1,\dots,X_n]/I \) be a Weil algebra. Earlier we observed that we can evaluate (classes of) polynomials in \( W \) at elements of \( \spec_R(W) \) (just replace \( C \) with \( R \)). In other words each element of \( W \) defines a mapping \( \spec_R(W)\to R \)
\begin{equation*}
  W\to R^{\spec_R(W)}
\end{equation*}

In the same manner we also obtain a mapping
\begin{equation*}
  \alpha : R[W]\to R^{\spec_R(W)}
\end{equation*}
again given by sending \( (p+I)\in R[W] \) to the map \( a\mapsto p(a) \). It is of course an algebra homomorphism. The KL Axiom asserts that it is bijective.
\begin{axiom}[KL]
  Let \( W\cong \mathbb{Q}[X_1,\dots,X_n]/I \) be a Weil algebra. Then the map
  \begin{equation*}
    \alpha : R[W]\to R^{\spec_R(W)}
  \end{equation*}
  given by \( p+I \mapsto (a\mapsto p(a)) \) is an \( R \)-algebra isomorphism.
  \label{ax:genKL}
\end{axiom}

By asserting this axiom we obtain many of the propositions in the first part of this monograph in a stronger version, and further generalizations. But before looking at those examples we'll note that the first KL axiom given is too a consequence of axiom \ref{ax:genKL}. This can be seen simply by applying the axiom to the Weil algebra \( \mathbb{Q}[X]/(X^2) \). The result is the equivalent version of axiom \ref{KL1} that we had already observed in section \ref{ax1re}.

What the general KL axiom provides is essentially, given a particular set of ``small'' elements of \( R \), a correspondence between functions from that set to \( R \) with a particular finite dimensional \( R \)-algebra. These ``small'' elements are the objects \( \spec_R(W) \) for some Weil algebra \( W \). We refer to them as ``small'' because they are meant to be a rigorization of the historically nebulous concept of ``infinitesimals''. We first introduced nilsquares (\( \spec_R(Q[X]/(X^2)) \)), on which all functions are affine, giving us first order derivatives. The Taylor formulas that came afterwards were restricted, however, to sums of elements of \( D \) and not any nilpotent element of \( R \). Since other nilpotents are too spectra of certain Weil algebra, we now have Taylor formulae for these, given by axiom \ref{ax:genKL}. We'll look at a few such spectra, study the KL axiom in regards to them and at the same time introduce their common nomenclature.

\begin{itemize}
  \item \( D_k := \spec_R(W_{k+1}) \) with \( W_{k+1} = \mathbb{Q}[X]/(X^{k+1}) \). These are elements of \( R \) whose \( (k+1) \)-th power is zero (in particular \( D_2 = D \)). One can check that \( W_{k+1} \) is isomorphic to the the set \( \{a_0+a_1\epsilon + \dots + a_k\epsilon^k\ \mid a_i\in R\} \) with \( \epsilon \) denoting the equivalence class of \( X \) in \( W_{k+1} \). By axiom \ref{ax:genKL} the set of functions \( D_k\to R \) are isomorphic as an \( R \)-algebra to the algebra \( W_{k+1} \). Another way of saying this is that:
    \begin{proposition}
      For all functions \( g:D_k\to R \) there exist unique coefficients \( a_0,\dots,a_k\in R \) such that
      \begin{equation*}
	 g(\delta) = a_0 + a_1\delta + \dots + a_k\delta^k \quad \forall\delta\in D_k
      \end{equation*}
    \end{proposition}
    And as an immediate consequence we have that, for any \( f:R\to R \) there exist unique coefficients \( a_0,\dots,a_k\in R \) such that
    \begin{equation*}
      f(x+\delta) = a_0 + a_1\delta + \dots + a_k\delta^k \quad \forall \delta\in R\, :\, \delta^{k+1}=0
    \end{equation*}
    That is, we have Taylor formulas of all orders (and one can check that the \( a_i \) are precisely the Taylor coefficients).

    %TODO: make sure of this
  \item \( (D_k)^n := \spec_R((W_{k+1})^n) \) where \( (W_{k+1})^n \) just means the Cartesian product with itself \( n \) times (and so does taking the spectrum of the product of \( W_k \) coincide with the product of \( D_k \)). This is a Weil algebra, and it is presented by \( \mathbb{Q}[X_1,\dots,X_n](X_1^{k+1},\dots,X_n^{k+1}) \) . The general KL axiom applied to this particular algebra is what yields higher dimensional Taylor formulae. We state it now without proof (a tedious but simple combinatorial exercise).
    \begin{proposition}
      For any function \( f:R^n\to R \),
      \begin{equation*}
	f( \vec{x} + \vec{\delta} ) = \sum_{\alpha \leq k}{\frac{\vec{\delta}}{\alpha!}\cdot\frac{\partial^{\abs\alpha}f}{\partial x^\alpha}(\vec{x})}\quad \forall \delta : \delta^{k+1}=0
      \end{equation*}
    \end{proposition}
    where we're using the usual multi-index notation - if \( \alpha=(\alpha_1,\dots,\alpha_n) \) then \( \abs\alpha = \alpha_1+\dots+\alpha_n \), \( \alpha! = \alpha_1!\cdot\dots\cdot\alpha_n! \) and \( \frac{\partial^{\abs\alpha}f}{\partial x^\alpha}=\frac{\partial^{\abs\alpha}f}{\partial x^{\alpha_1}\dots\partial x^{\alpha_n}} \). The partial derivatives are defined in the same way as before.
  \item \( D(n) := \spec_R(W(n)) \) where 
    \begin{equation*}
        W(n) = \Q[X_1,\dots,X_n]/(\{X_iX_j\}_{1\leq i,j \leq n})
    \end{equation*}
    A simpler way of writing this is
    \begin{equation*}
      D(n) = \{(d_1,\dots,d_n)\subset R^n\mid \text{the product of any two \( d_i,d_j \) is zero}\}
    \end{equation*}
  \item \( D_k(n) := \spec_R(W_k(n)) \) where
    \begin{equation*}
      W_k(n) = \Q[X_1,\dots,X_n]/(\{X_{i_1}\cdots X_{i_k}\}_{1\leq i_1,\dots,i_k\leq n})
    \end{equation*}
   Again these are the elements of \( R^n \) such that the product of any \( k \) of their components is equal to zero.
\end{itemize}

There are some notable inclusions:

\begin{align*}
  D_k(n)  &\subset D_l(n)             \text{ iff k\(\leq\) l} \\
  D_k(n)  &\subset (D_k)^n            \\
  (D_k)^n &\subset D_{n\cdot k}(n)   
\end{align*}
